<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Mars</title>
    
    <link rel="stylesheet" href="/style.css" />
    
    
    <!--   jquery   -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!--   uikit   -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/2.27.5/css/uikit.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/2.27.5/js/uikit.min.js"></script>
  
    <!-- Orbitron font from google  -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="/style.css" />
    
  </head>
  
  
  <body>
    
    <span data-current-sol></span>

    <div class="uk-container uk-container-center uk-margin-top">
    <ul class="uk-grid" data-uk-grid-margin>
      
      <!--   row1 col1-2  title & text  -->
      <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-2-3">
        <div class="uk-panel uk-panel-box">
          <h1>Mars Right Now</h1>
          <p>
            You are one of the first settlers in the Mars colony, which has not yet been terraformed. 
            You need to do structural repairs outside of the base which has a sealed atmosphere, so need support from NASA to give you a dashboard on the weather outside of the base. 
            You need to know things like wind direction and temperature as this can affect which space suit you need to wear or what gear you need to take with you.
          </p>
        </div>
      </li>
      
      <!--   row1 col3  illustration  -->
      <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-1-3">
        <div class="uk-panel uk-panel-box">
          <h2>illustration</h2>
          
        </div>
      </li>
      
      <!--   row2 col1-2  Map   -->
      <!--    mars map is a page  https://api.nasa.gov/mars-wmts/catalog/HRSC_Martian_east.html    -->
      <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-2-3">
        <div class="uk-panel uk-panel-box">
          <h2>Mars Map</h2>
          
          <iframe src="https://www.google.com/mars">
            
          </iframe>
          
        </div>
      </li>
      
      <!--   row2 col3  podcast  -->
      <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-1-3">
        <div class="uk-panel uk-panel-box">
          <h2>Podcast</h2>
          
        </div>
      </li>
      
     <!--   row3 col1-2  Weather   -->
      <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-2-3">
        <div class="uk-panel uk-panel-box">
          <h2>Weather</h2>
          
            <!--     weather details       -->
          <ul class="uk-grid" data-uk-grid-margin>
             
              <!--   Temperature        -->
             <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-1-1">
               <h3>Temperature</h3>
             </li>
             
             <!--   Atmospheric pressure     -->
             <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-1-2">
               <h3>Atmospheric pressure </h3>
             </li>
             
             <!--     Wind direction and speed     -->
             <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-1-2">
               <h3>Atmospheric pressure </h3>
             </li>
             
             <!--     Atmospheric Opacity     -->
             <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-1-1">
               <h3>Atmospheric Opacity</h3>
             </li>
           </ul>

        </div>
      </li>
      <!--   end of weather     -->
      
      <!--   row3 col3 Spacesuits -->
      <li class="uk-width-small-1-1 uk-width-medium-1-2 uk-width-large-1-3">
        <div class="uk-panel uk-panel-box">
          <h2>Spacesuits Recommendations</h2>
          <p>Today you need to: </p>
          

        </div>
      </li>
      
      <!--  row 4 Mars Rover image -->     
      <li class="uk-width-small-1-1 uk-width-medium-1-1 uk-width-large-1-1">
        <div class="uk-panel uk-panel-box">
          <h2>Mars Rover Image</h2>
          
        </div>
      </li>
      

    </ul>
  </div>

    <!--     <div class="glitchButton" style="position:fixed;top:20px;right:20px;"></div>
    <script src="https://button.glitch.me/button.js" defer></script> -->
    
        <script>
    
    const API_URL = 'https://api.nasa.gov/insight_weather/?api_key=c5dPEdEiY4toYIxZa7Zeaog1MFJl4pVCkOCb0CVs&feedtype=json&ver=1.0'

    // Change this if you need to
    const previousWeatherToggle = document.querySelector('.show-previous-weather');

    const previousWeather = document.querySelector('.previous-weather')
    
    const currentSolElement = document.querySelector('[data-current-sol]')

    previousWeatherToggle.addEventListener('click', () => {
        previousWeather.classList.toggle('show-weather')
    })
        
    let selectedSolIndex

    getWeather().then(sols => {
        selectedSolIndex = sols.length - 1
        displaySelectedSol(sols)
    })
        
    function displaySelectedSol(sols){
        const selectedSol = sols[selectedSolIndex]
//        console.log(selectedSol)
        currentSolElement.innerText = selectedSol.sol
    }

    function getWeather(){
        return fetch(API_URL)
            .then(res => res.json())
            .then(data => {
            const{
                sol_keys,
                validity_checks,
                ...solData
            } = data
    //        console.log(solData)
            return Object.entries(solData).map(([sol,data])=>{
                return {
                    sol:sol,
                    maxTemp: data?.AT?.mx,
                    minTemp: data?.AT?.mn,
                    windSpeed: data?.HWS?.av,
                    windDirectionDegress: data.WD.most_common?.compass_degrees,
                    windDirectionCardinal: data.WD.most_common?.compass_point,
                    date: new Date(data.First_UTC)
                }
            })
    
            console.log(temp)
        })
    }
        
        
    
    </script>
    
    
  </body>
</html>
